trained_model_name: gemma-1.1-7b-it_gsm8k_ent0.05_beam1_dosampleFalse_temp1.0_estep__totalepoch1
Parameter Offload: Total persistent parameters: 175104 in 57 params
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                 | 0/117 [00:00<?, ?it/s]/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/utils/checkpoint.py:92: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
query_decode: ['Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Ahmed and Emily are having a contest to see who can get the best grade in the class. There have been 9 assignments and Ahmed has a 91 in the class. Emily has a 92. The final assignment is worth the same amount as all the other assignments. Emily got a 90 on the final assignment. What is the minimum grade Ahmed needs to get to beat Emily if all grades are whole numbers?', 'Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: The gauge on a water tank shows that the tank is 1/3 full of water. To fill the tank, 16 gallons of water are added. How many gallons of water does the tank hold when full?', "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: There are 15 tables in the school's cafeteria. Each table can seat 10 people. Usually, only 1/10 of the seats are left unseated. How many seats are usually taken?", "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Fiona completed 36 math questions in an hour. Shirley was able to complete twice as many math questions within that same time, and Kiana completed half of the sum of Fiona and Shirley's math questions. If they each did the same number of questions the following hour, how many math questions did all three girls complete in 2 hours?"]
rational_decode: ['Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Ahmed and Emily are having a contest to see who can get the best grade in the class. There have been 9 assignments and Ahmed has a 91 in the class. Emily has a 92. The final assignment is worth the same amount as all the other assignments. Emily got a 90 on the final assignment. What is the minimum grade Ahmed needs to get to beat Emily if all grades are whole numbers? Answer: The final assignment is worth the same as all the other assignments, so it is worth 9 * 1 = 9 points. Ahmed needs to get a 92 to beat Emily on the final assignment.', 'Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: The gauge on a water tank shows that the tank is 1/3 full of water. To fill the tank, 16 gallons of water are added. How many gallons of water does the tank hold when full? Answer: The tank holds 48 gallons of water when full.', "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: There are 15 tables in the school's cafeteria. Each table can seat 10 people. Usually, only 1/10 of the seats are left unseated. How many seats are usually taken? Answer: There are 15 tables with 10 seats each, so there are 15 * 10 = 150 seats in total. Usually, only 1/10 of the seats are left unseated, so 150 * 9/10 = 135 seats are usually taken.", "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Fiona completed 36 math questions in an hour. Shirley was able to complete twice as many math questions within that same time, and Kiana completed half of the sum of Fiona and Shirley's math questions. If they each did the same number of questions the following hour, how many math questions did all three girls complete in 2 hours? Answer: The number of math questions Fiona completed in an hour is 36. Shirley completed twice that, so she completed 36 * 2 = 72 math questions in an hour. Kiana completed half of the sum of Fiona and Shirley's math questions, so she completed (36 + 72) / 2 = 54 math questions in an hour. Together, they completed 36 + 72 + 54 = 162 math questions in 2 hours."]
answer_decode: ['The answer is 100.', 'The answer is 24.', 'The answer is 135.', 'The answer is 324.']
Token indices sequence length is longer than the specified maximum sequence length for this model (281 > 256). Running this sequence through the model will result in indexing errors
xz: tensor([     2,   1261,    573,   2872,   3482,    611,    573,   2412,   3287,
        235292,    108,   9413, 235292,  73605, 235349, 235256,   2001,   1503,
           919,   2149,  23246,  11187,   1178,  11270,   9149, 235349, 235256,
          2001,   1503, 235265,   1927,  11270,   9149,   3895,   1378,  11187,
          1401,   1070,   2001,   1503, 235269,   1284,   1134,    791,    476,
          2001,   1503,  11594,    573,   4191,    576,  40742, 235349, 235256,
        235265,  40742, 235349, 235256,   2247,   1503,    603,  40742,  25685,
        235265,   2250,   1767,  11187,    708,    575,  73605, 235349, 235256,
          2001,   1503, 235336,  10358, 235292,   2456,    708, 235248, 235310,
         11187,    575,  40742, 235349, 235256,   2001,   1503, 235269,    712,
         11270,   9149, 235349, 235256,   1503,    603, 235248, 235310, 235287,
        235284,    963, 235284,    589, 235248, 235274, 235276,  11187,   1497,
        235265,  73605, 235349, 235256,   2001,   1503,    603, 235248, 235304,
         11187,  25270,   1178,  11270,   9149, 235349, 235256, 235269,    712,
          1104,    708, 235248, 235274, 235276,    728, 235248, 235304,    589,
        235248, 235324,  11187,    575,  73605, 235349, 235256,   2001,   1503,
        235265,    108,   9413, 235292,  35811,    578,  31325,    708,   3372,
           476,  17418,    577,   1443,   1064,    798,    947,    573,   1963,
         10745,    575,    573,   1062, 235265,   2456,    791,   1125, 235248,
        235315,  38988,    578,  35811,    919,    476, 235248, 235315, 235274,
           575,    573,   1062, 235265,  31325,    919,    476, 235248, 235315,
        235284, 235265,    714,   2048,  22312,    603,   5123,    573,   1809,
          3619,    685,    832,    573,   1156,  38988, 235265,  31325,   2371,
           476, 235248, 235315, 235276,    611,    573,   2048,  22312, 235265,
          2439,    603,    573,   8773,  10745,  35811,   4026,    577,    947,
           577,  10270,  31325,   1013,    832,  25148,    708,   3733,   5968,
        235336,  10358, 235292,    714,   2048,  22312,    603,   5123,    573,
          1809,    685,    832,    573,   1156,  38988, 235269,    712,    665,
           603,   5123, 235248, 235315,    649, 235248, 235274,    589, 235248,
        235315,   3782, 235265,  35811,   4026,    577,    947,    476, 235248,
        235315, 235284,    577,  10270,  31325,    611,    573,   2048,  22312,
        235265,    108,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1], device='cuda:0')
xz_labels: tensor([  -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,  10358, 235292,    714,   2048,  22312,    603,   5123,    573,
          1809,    685,    832,    573,   1156,  38988, 235269,    712,    665,
           603,   5123, 235248, 235315,    649, 235248, 235274,    589, 235248,
        235315,   3782, 235265,  35811,   4026,    577,    947,    476, 235248,
        235315, 235284,    577,  10270,  31325,    611,    573,   2048,  22312,
        235265,    108,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100], device='cuda:0')
decode x:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Ahmed and Emily are having a contest to see who can get the best grade in the class. There have been 9 assignments and Ahmed has a 91 in the class. Emily has a 92. The final assignment is worth the same amount as all the other assignments. Emily got a 90 on the final assignment. What is the minimum grade Ahmed needs to get to beat Emily if all grades are whole numbers?
decode xz:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Ahmed and Emily are having a contest to see who can get the best grade in the class. There have been 9 assignments and Ahmed has a 91 in the class. Emily has a 92. The final assignment is worth the same amount as all the other assignments. Emily got a 90 on the final assignment. What is the minimum grade Ahmed needs to get to beat Emily if all grades are whole numbers? Answer: The final assignment is worth the same as all the other assignments, so it is worth 9 * 1 = 9 points. Ahmed needs to get a 92 to beat Emily on the final assignment.
<eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos>
decode xzy:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Ahmed and Emily are having a contest to see who can get the best grade in the class. There have been 9 assignments and Ahmed has a 91 in the class. Emily has a 92. The final assignment is worth the same amount as all the other assignments. Emily got a 90 on the final assignment. What is the minimum grade Ahmed needs to get to beat Emily if all grades are whole numbers? Answer: The final assignment is worth the same as all the other assignments, so it is worth 9 * 1 = 9 points. Ahmed needs to get a 92 to beat Emily on the final assignment.
The answer is 100.<eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos>
/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
Could not estimate the number of tokens of the input, floating-point operations will not be computed
query_decode: ['Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Mary bought a packet of 1500 stickers. She shared them between Susan, Andrew and Sam in the ratio 1:1:3 respectively. If Sam gave Andrew two-thirds of his own share, how many stickers does Andrew now have?', "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Milo can roll downhill on his skateboard at twice the speed that he can run.  And Milo's best friend, Cory, can drive his wheelchair at twice the speed that Milo can roll downhill on his skateboard.  If Cory always drives his wheelchair at 12 miles per hour, how many miles can Milo run in two hours?", "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Connie is trying to remember when her grandmother was born. She knows her grandmother's older brother was born in 1932, her older sister was born in 1936, and the gap between her grandmother and her sister is twice the gap between the older brother and the older sister. What year was Connie's grandma born?", 'Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: The price per organic egg is 50 cents. The price of a tray of eggs that contains 30 eggs is $12. How much can you save, in cents, per egg if you buy a tray versus individual eggs?']
rational_decode: ['Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Mary bought a packet of 1500 stickers. She shared them between Susan, Andrew and Sam in the ratio 1:1:3 respectively. If Sam gave Andrew two-thirds of his own share, how many stickers does Andrew now have? Answer: There are 1500 stickers in total. Let x be the number of stickers Andrew has. Then, the number of stickers Susan has is x and the number of stickers Sam has is 3x. Sam gave Andrew two-thirds of his own share, so he gave Andrew (3x/3) = x stickers. Therefore, Andrew now has x + x = 2x stickers.', "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Milo can roll downhill on his skateboard at twice the speed that he can run.  And Milo's best friend, Cory, can drive his wheelchair at twice the speed that Milo can roll downhill on his skateboard.  If Cory always drives his wheelchair at 12 miles per hour, how many miles can Milo run in two hours? Answer: The speed of Milo running is half the speed of his skateboarding.  The speed of Cory driving is twice the speed of Milo skateboarding.  So the speed of Milo running is 12 / 2 = 6 miles per hour.  Milo can run 6 miles in two hours.", "Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: Connie is trying to remember when her grandmother was born. She knows her grandmother's older brother was born in 1932, her older sister was born in 1936, and the gap between her grandmother and her sister is twice the gap between the older brother and the older sister. What year was Connie's grandma born? Answer: The gap between the older brother and the older sister is 1936 - 1932 = 4 years. The gap between the older sister and the grandmother is twice the gap between the older brother and the older sister, so the gap is 4 * 2 = 8 years. The grandmother was born in 1936 - 8 = 1928.", 'Answer the question based on the following example:\nQuestion: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.\nQuestion: The price per organic egg is 50 cents. The price of a tray of eggs that contains 30 eggs is $12. How much can you save, in cents, per egg if you buy a tray versus individual eggs? Answer: The price of an individual egg is 50 cents. The price of a tray of eggs is $12. The difference is 12
answer_decode: ['The answer is 900.', 'The answer is 6.', 'The answer is 1944.', 'The answer is 10.']
xz: tensor([     2,   1261,    573,   2872,   3482,    611,    573,   2412,   3287,
        235292,    108,   9413, 235292,  73605, 235349, 235256,   2001,   1503,
           919,   2149,  23246,  11187,   1178,  11270,   9149, 235349, 235256,
          2001,   1503, 235265,   1927,  11270,   9149,   3895,   1378,  11187,
          1401,   1070,   2001,   1503, 235269,   1284,   1134,    791,    476,
          2001,   1503,  11594,    573,   4191,    576,  40742, 235349, 235256,
        235265,  40742, 235349, 235256,   2247,   1503,    603,  40742,  25685,
        235265,   2250,   1767,  11187,    708,    575,  73605, 235349, 235256,
          2001,   1503, 235336,  10358, 235292,   2456,    708, 235248, 235310,
         11187,    575,  40742, 235349, 235256,   2001,   1503, 235269,    712,
         11270,   9149, 235349, 235256,   1503,    603, 235248, 235310, 235287,
        235284,    963, 235284,    589, 235248, 235274, 235276,  11187,   1497,
        235265,  73605, 235349, 235256,   2001,   1503,    603, 235248, 235304,
         11187,  25270,   1178,  11270,   9149, 235349, 235256, 235269,    712,
          1104,    708, 235248, 235274, 235276,    728, 235248, 235304,    589,
        235248, 235324,  11187,    575,  73605, 235349, 235256,   2001,   1503,
        235265,    108,   9413, 235292,   7473,   8989,    476,  25514,    576,
        235248, 235274, 235308, 235276, 235276,  33954, 235265,   2475,   8934,
          1174,   1865,  25729, 235269,  15970,    578,   5485,    575,    573,
          9537, 235248, 235274, 235292, 235274, 235292, 235304,  11235, 235265,
          1927,   5485,   5645,  15970,   1378, 235290,  52270,    576,    926,
          1997,   4638, 235269,   1368,   1767,  33954,   1721,  15970,   1490,
           791, 235336,  10358, 235292,   2456,    708, 235248, 235274, 235308,
        235276, 235276,  33954,    575,   3051, 235265,   4371,   1141,    614,
           573,   1758,    576,  33954,  15970,    919, 235265,   5040, 235269,
           573,   1758,    576,  33954,  25729,    919,    603,   1141,    578,
           573,   1758,    576,  33954,   5485,    919,    603, 235248, 235304,
        235297, 235265,   5485,   5645,  15970,   1378, 235290,  52270,    576,
           926,   1997,   4638, 235269,    712,    693,   5645,  15970,    591,
        235304, 235297, 235283, 235304, 235275,    589,   1141,  33954, 235265,
         11569, 235269,  15970,   1490,    919,   1141,    963,   1141,    589,
        235248, 235284, 235297,  33954, 235265,    108,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1,      1,
             1,      1,      1,      1,      1,      1,      1,      1],
       device='cuda:0')
xz_labels: tensor([  -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,  10358, 235292,   2456,    708, 235248, 235274, 235308,
        235276, 235276,  33954,    575,   3051, 235265,   4371,   1141,    614,
           573,   1758,    576,  33954,  15970,    919, 235265,   5040, 235269,
           573,   1758,    576,  33954,  25729,    919,    603,   1141,    578,
           573,   1758,    576,  33954,   5485,    919,    603, 235248, 235304,
        235297, 235265,   5485,   5645,  15970,   1378, 235290,  52270,    576,
           926,   1997,   4638, 235269,    712,    693,   5645,  15970,    591,
        235304, 235297, 235283, 235304, 235275,    589,   1141,  33954, 235265,
         11569, 235269,  15970,   1490,    919,   1141,    963,   1141,    589,
        235248, 235284, 235297,  33954, 235265,    108,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100,
          -100,   -100,   -100,   -100,   -100,   -100,   -100,   -100],
       device='cuda:0')
decode x:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Mary bought a packet of 1500 stickers. She shared them between Susan, Andrew and Sam in the ratio 1:1:3 respectively. If Sam gave Andrew two-thirds of his own share, how many stickers does Andrew now have?<eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos>
decode xz:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Mary bought a packet of 1500 stickers. She shared them between Susan, Andrew and Sam in the ratio 1:1:3 respectively. If Sam gave Andrew two-thirds of his own share, how many stickers does Andrew now have? Answer: There are 1500 stickers in total. Let x be the number of stickers Andrew has. Then, the number of stickers Susan has is x and the number of stickers Sam has is 3x. Sam gave Andrew two-thirds of his own share, so he gave Andrew (3x/3) = x stickers. Therefore, Andrew now has x + x = 2x stickers.
<eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos>
decode xzy:  <bos>Answer the question based on the following example:
Question: Samanthaâ€™s last name has three fewer letters than Bobbieâ€™s last name. If Bobbie took two letters off her last name, she would have a last name twice the length of Jamieâ€™s. Jamieâ€™s full name is Jamie Grey. How many letters are in Samanthaâ€™s last name? Answer: There are 4 letters in Jamieâ€™s last name, so Bobbieâ€™s name is 4*2 +2 = 10 letters long. Samanthaâ€™s last name is 3 letters shorter than Bobbieâ€™s, so there are 10 - 3 = 7 letters in Samanthaâ€™s last name.
Question: Mary bought a packet of 1500 stickers. She shared them between Susan, Andrew and Sam in the ratio 1:1:3 respectively. If Sam gave Andrew two-thirds of his own share, how many stickers does Andrew now have? Answer: There are 1500 stickers in total. Let x be the number of stickers Andrew has. Then, the number of stickers Susan has is x and the number of stickers Sam has is 3x. Sam gave Andrew two-thirds of his own share, so he gave Andrew (3x/3) = x stickers. Therefore, Andrew now has x + x = 2x stickers.
The answer is 900.<eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos><eos>
Invalidate trace cache @ step 47244: expected module 398, but got module 794
Traceback (most recent call last):
  File "/home/cyc2202/xyzo/proj_file/xyzo/E_step_ent.py", line 363, in <module>
    trainer.train()
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 2052, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 2388, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 3485, in training_step
    loss = self.compute_loss(model, inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/xyzo/proj_file/xyzo/E_step_ent.py", line 210, in compute_loss
    rational = model.generate(input_ids=inputs_ids_q_l, attention_mask=mask_q_l, \
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/generation/utils.py", line 2047, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/generation/utils.py", line 3007, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 1069, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 847, in forward
    causal_mask = self._update_causal_mask(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 948, in _update_causal_mask
    min_dtype = torch.finfo(dtype).min
                ^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/cyc2202/xyzo/proj_file/xyzo/E_step_ent.py", line 363, in <module>
[rank0]:     trainer.train()
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 2052, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 2388, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/trainer.py", line 3485, in training_step
[rank0]:     loss = self.compute_loss(model, inputs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/xyzo/proj_file/xyzo/E_step_ent.py", line 210, in compute_loss
[rank0]:     rational = model.generate(input_ids=inputs_ids_q_l, attention_mask=mask_q_l, \
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/generation/utils.py", line 2047, in generate
[rank0]:     result = self._sample(
[rank0]:              ^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/generation/utils.py", line 3007, in _sample
[rank0]:     outputs = self(**model_inputs, return_dict=True)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
[rank0]:     result = forward_call(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 1069, in forward
[rank0]:     outputs = self.model(
[rank0]:               ^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
[rank0]:     result = forward_call(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 847, in forward
[rank0]:     causal_mask = self._update_causal_mask(
[rank0]:                   ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/cyc2202/anaconda3/envs/yuan/lib/python3.11/site-packages/transformers/models/gemma/modeling_gemma.py", line 948, in _update_causal_mask
[rank0]:     min_dtype = torch.finfo(dtype).min
[rank0]:                 ^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
